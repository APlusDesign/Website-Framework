function startApplication(){websiteFramework.LOCAL=$("#local-root").length,websiteFramework.controls=userControls(),domHelpers(),console.log(websiteFramework)}function domHelpers(){newWindows(),fancyLinks()}function newWindows(){$("._blank").each(function(){$(this).attr("target","_blank").removeClass("_blank")})}function fancyLinks(){$(".fancylink").fancybox({nextMethod:"resizeIn",nextSpeed:250,prevMethod:!1,type:"ajax",beforeLoad:function(){var t=$(this.element);"gallery"==t.data("fancyboxGroup")&&(this.type="image")},beforeShow:function(){""!=this.title&&(this.title+=" - "),this.title+='<a class="btn-contact" href="/ajax?view=contact">Contact Us</a>'},helpers:{overlay:{locked:!1}}})}function userControls(){var t=$(".btn-logout");return t.length&&t.click(function(t){t.preventDefault(),logoutUser()}),{login:fancyboxAjaxForm($(".btn-login"),function(){new formHelper({formId:"login",buttonTxt:"Login",callback:function(t){$.fancybox.close(),t.updates?window.location.reload():alert("Error: Not sure what went wrong with your request, please refresh the page")}});var t=$(".forgot-password");t.length&&t.fancybox({type:"ajax",afterShow:function(){new formHelper({formId:"forgot",buttonTxt:"Reset"})}})}),register:fancyboxAjaxForm($(".btn-register"),function(){new formHelper({formId:"register",buttonTxt:"Register"})}),contact:fancyboxAjaxForm($(".btn-contact"),function(){new formHelper({formId:"contact"})}),logout:t}}function fancyboxAjaxForm(t,e){return t.length&&t.fancybox({type:"ajax",ajax:{type:"GET",data:{ajax:1}},afterShow:e}),t}function formHelper(t){var e={formId:"",buttonClass:"",buttonTxt:"Submit",callback:function(t){$(".window-wrapper").html(t.html)}};this.options=jQuery.extend(e,t),this.init=function(){this.getElements(),this.setElements()},this.getElements=function(){this.form=$("#"+this.options.formId),this.submit=this.form.find('input[type="submit"]'),this.wrapper=$(".actions")},this.setElements=function(){var t=this;this.submit.remove(),this.button=$("<button class='framework-button "+this.options.formId+"-button'></button>").html(this.options.buttonTxt).addClass(this.options.buttonClass).click(function(e){return e.preventDefault(),t.formCheck(),!1}),this.wrapper.append(this.button),this.error=new errorHelper(this.form)},this.formCheck=function(){this.button.attr("disabled","disabled"),this.overlay=new ajaxLoader(".fancybox-wrap"),this.send()},this.send=function(){var t=this,e=function(e){var i=e;t.overlay.remove(),i.errors?(t.error.insertErrors(i),t.button.attr("disabled",!1)):t.options.callback(i)};$.getJSON(this.form.attr("action"),this.form.serializeObject(),e)},this.init()}function errorHelper(t,e){var i={};this.options=jQuery.extend(i,e),this.init=function(){this.errorWrapper=$("<div>").addClass("error-wrap"),this.form.append(this.errorWrapper)},this.insertErrors=function(t){var e=this,i=t.errors;this.removeErrors(),$.each(i,function(t,i){e.insertError(i),e.displayError(t)})},this.insertError=function(t){this.errorWrapper.append($("<p class='reg-error'></p>").html(t))},this.displayError=function(t){var e=$("#"+t);e.length&&e.parent().addClass("error")},this.removeErrors=function(){this.errorWrapper.find("p.reg-error").remove(),this.form.find(".error").removeClass("error")},this.form=t,this.form.length&&this.init()}function ajaxLoader(t,e){var i={bgColor:"#fff",duration:300,opacity:.7,classOveride:!1};this.options=jQuery.extend(i,e),this.container=$(t),this.init=function(){var t=this.container;this.remove();var e=$("<div></div>").css({"background-color":this.options.bgColor,opacity:this.options.opacity,width:t.outerWidth(),height:t.outerHeight(),position:"absolute",top:"0",left:"0"}).addClass("ajax_overlay");this.options.classOveride&&e.addClass(this.options.classOveride),t.append(e.append($("<div></div>").addClass("imgSpinner icon-spin5")).fadeIn(this.options.duration))},this.remove=function(t){var e=this.container.children(".ajax_overlay");e.length&&(t?e.remove():e.fadeOut(this.options.classOveride,function(){e.remove()}))},this.init()}var logoutUser=function(){new ajaxLoader("body"),$.ajax({type:"POST",cache:!1,url:"/ajax/",data:{flag:"logout",ajax:1},complete:function(){window.location.reload()}})};$.fn.serializeObject=function(){var t={},e=this.serializeArray();return $.each(e,function(){t[this.name]?(t[this.name].push||(t[this.name]=[t[this.name]]),t[this.name].push(this.value||"")):t[this.name]=this.value||""}),t},function(t,e){e.transitions.resizeIn=function(){var i=e.previous,s=e.current,n=i.wrap.stop(!0).position(),r=t.extend({opacity:1},s.pos);n.width=i.wrap.width(),n.height=i.wrap.height(),i.wrap.stop(!0).trigger("onReset").remove(),delete r.position,s.inner.hide(),s.wrap.css(n).animate(r,{duration:s.nextSpeed,easing:s.nextEasing,step:e.transitions.step,complete:function(){e._afterZoomIn(),s.inner.fadeIn("fast")}})}}(jQuery,jQuery.fancybox);