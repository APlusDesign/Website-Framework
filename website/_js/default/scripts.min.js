function startApplication(){websiteFramework.LOCAL=$("#local-root").length,websiteFramework.controls=userControls(),fancy_setup(),newWindow_setup(),console.log(websiteFramework)}function newWindow_setup(){$.each($("._blank"),function(){$(this).attr("target","_blank").removeClass("_blank")})}function fancy_setup(){$(".fancylink").fancybox({nextMethod:"resizeIn",nextSpeed:250,prevMethod:!1,beforeShow:function(){}})}function userControls(){var t=$(".btn-logout");return t.length&&t.click(function(t){t.preventDefault(),logoutUser()}),{login:fancyboxAjaxForm($(".btn-login"),function(){new formHelper({formId:"login",buttonTxt:"Login",callback:function(t){$.fancybox.close(),t.updates?window.location.reload():alert("Error: Not sure what went wrong with your request, please refresh the page")}});var t=$(".forgot-password");t.length&&t.fancybox({afterShow:function(){new formHelper({formId:"forgot",buttonTxt:"Reset"})}})}),register:fancyboxAjaxForm($(".btn-register"),function(){new formHelper({formId:"register",buttonTxt:"Register"})}),contact:fancyboxAjaxForm($(".btn-contact"),function(){new formHelper({formId:"contact"})}),logout:t}}function fancyboxAjaxForm(t,e){return t.length&&t.fancybox({type:"ajax",ajax:{type:"GET",data:{ajax:1}},afterShow:e}),t}function formHelper(t){var e={formId:"",buttonClass:"",buttonTxt:"Submit",callback:function(t){$("#ajax-form").html(t.html)}};this.options=jQuery.extend(e,t),this.init=function(){this.getElements(),this.setElements()},this.getElements=function(){this.form=$("#"+this.options.formId),this.submit=this.form.find('input[type="submit"]'),this.wrapper=$(".actions")},this.setElements=function(){var t=this;this.submit.remove(),this.button=$("<button class='framework-button large "+this.options.formId+"-button'></button>").html("<div></div><span>"+this.options.buttonTxt+"</span>").addClass(this.options.buttonClass).click(function(e){return e.preventDefault(),t.formCheck(),!1}),this.wrapper.append(this.button),this.error=new errorHelper(this.form)},this.formCheck=function(){this.button.attr("disabled","disabled"),this.overlay=new ajaxLoader(".fancybox-wrap"),this.send()},this.send=function(){var t=this,e=function(e){var r=e;t.overlay.remove(),r.errors?(t.error.insertErrors(r),t.button.attr("disabled",!1)):t.options.callback(r)};$.getJSON(this.form.attr("action"),this.form.serializeObject(),e)},this.init()}function errorHelper(t,e){var r={};this.options=jQuery.extend(r,e),this.init=function(){this.errorWrapper=$("<div>").addClass("error-wrap"),this.form.append(this.errorWrapper)},this.insertErrors=function(t){var e=this,r=t.errors;this.removeErrors(),$.each(r,function(t,r){e.insertError(r),e.displayError(t)})},this.insertError=function(t){this.errorWrapper.append($("<p class='reg-error'></p>").html(t))},this.displayError=function(t){var e=$("#"+t);e.length&&e.parent().addClass("error")},this.removeErrors=function(){this.errorWrapper.find("p.reg-error").remove(),this.form.find(".error").removeClass("error")},this.form=t,this.form.length&&this.init()}function isEmpty(t){for(var e in t)return!0;return!1}function ajaxLoader(t,e){var r={bgColor:"#fff",duration:300,opacity:.7,classOveride:!1};this.options=jQuery.extend(r,e),this.container=$(t),this.init=function(){var t=this.container;this.remove();var e=$("<div></div>").css({"background-color":this.options.bgColor,opacity:this.options.opacity,width:t.outerWidth(),height:t.outerHeight(),position:"absolute",top:"0",left:"0"}).addClass("ajax_overlay");this.options.classOveride&&e.addClass(this.options.classOveride),t.append(e.append($("<div></div>").addClass("ajax_loader")).fadeIn(this.options.duration))},this.remove=function(t){var e=this.container.children(".ajax_overlay");e.length&&(t?e.remove():e.fadeOut(this.options.classOveride,function(){e.remove()}))},this.init()}var logoutUser=function(t){new ajaxLoader("body"),$.ajax({type:"POST",cache:!1,url:"/ajax/",data:{flag:"logout",ajax:1},complete:function(){window.location.reload()}})};$.fn.serializeObject=function(){var t={},e=this.serializeArray();return $.each(e,function(){t[this.name]?(t[this.name].push||(t[this.name]=[t[this.name]]),t[this.name].push(this.value||"")):t[this.name]=this.value||""}),t},function(t,e){e.transitions.resizeIn=function(){var r=e.previous,i=e.current,n=r.wrap.stop(!0).position(),o=t.extend({opacity:1},i.pos);n.width=r.wrap.width(),n.height=r.wrap.height(),r.wrap.stop(!0).trigger("onReset").remove(),delete o.position,i.inner.hide(),i.wrap.css(n).animate(o,{duration:i.nextSpeed,easing:i.nextEasing,step:e.transitions.step,complete:function(){e._afterZoomIn(),i.inner.fadeIn("fast")}})}}(jQuery,jQuery.fancybox);