function startApplication(){websiteFramework.BASE_URL=document.getElementsByTagName("base")[0].href,websiteFramework.LOCAL=$("#local-root").length,websiteFramework.controls=userControls(),fancy_setup(),newWindow_setup(),console.log(websiteFramework)}function newWindow_setup(){var t=$("._blank");$.each(t,function(){$(this).attr("target","_blank").removeClass("_blank")})}function fancy_setup(){$(".fancylink").fancybox({nextMethod:"resizeIn",nextSpeed:250,prevMethod:!1,beforeShow:function(){}})}function userControls(){var t=$(".btn-login");t.length&&t.fancybox({ajax:{type:"GET",data:{ajax:1}},afterShow:function(){new loginUser}});var e=$(".btn-logout");e.length&&e.bind({click:function(t){t.preventDefault(),logoutUser()}});var i=$(".btn-register");i.length&&i.fancybox({ajax:{type:"GET",data:{ajax:1}},afterShow:function(){new registerUser},afterClose:function(){}});var r=$(".btn-contact");return r.length&&r.fancybox({ajax:{type:"GET",data:{ajax:1}},afterShow:function(){new contact}}),{login:t,logout:e,register:i,contact:r}}function registerUser(t,e){var i={};this.options=jQuery.extend(i,e),this.init=function(){this.getElements(),this.setElements()},this.getElements=function(){this.form=$("#registration"),this.userName=$("#reg-username input"),this.userPass=$("#reg-password input"),this.userPass2=$("#reg-password2 input"),this.userEmail=$("#reg-email input"),this.wrapper=$(".register-action"),this.wrapper.find('input[type="submit"]').remove()},this.setElements=function(){var t=this;this.button=$("<button>").html("<div></div><span>Register with us</span>").addClass("framework-button large register-button").click(function(e){return e.preventDefault(),t.regCheck(),!1}),this.wrapper.append(this.button),this.error=new errorHelper(this.wrapper)},this.regCheck=function(){this.button.attr("disabled","disabled"),this.overlay=new ajaxLoader(".fancybox-wrap"),this.data={username:this.userName.val(),password:this.userPass.val(),password2:this.userPass2.val(),email:this.userEmail.val(),flag:"register"},this.save()},this.save=function(){var t=this,e=function(e){var i=e;t.overlay.remove(),i.errors?(t.error.insertErrors(i),t.button.attr("disabled",!1)):$(".fancybox-wrap").find(".pre-window-wrap").html(i.html)};$.getJSON(websiteFramework.BASE_URL+"ajax/",this.data,e)},this.init()}function loginUser(t,e){var i={};this.options=jQuery.extend(i,e),this.init=function(){this.getElements(),this.setElements()},this.getElements=function(){this.form=$("#login"),this.userName=$("#reg-username input"),this.userPass=$("#reg-password input"),this.auto=$("#reg-auto input[name=auto]"),this.wrapper=$(".login-action"),this.wrapper.find('input[type="submit"]').remove()},this.setElements=function(){var t=this,e=$(".forgot-password");e.length&&e.fancybox({afterShow:function(){new forgotUser}}),this.button=$("<button>").html("<div></div><span>Login</span>").addClass("framework-button large login-button").click(function(e){return e.preventDefault(),t.regCheck(),!1}),this.wrapper.append(this.button),this.error=new errorHelper(this.wrapper)},this.regCheck=function(){this.button.attr("disabled","disabled"),this.overlay=new ajaxLoader(".fancybox-wrap"),this.data={username:this.userName.val(),password:this.userPass.val(),auto:this.auto.val(),flag:"login"},this.save()},this.save=function(){var t=this,e=function(e){var i=e;t.overlay.remove(),i.errors?(t.error.insertErrors(i),t.button.attr("disabled",!1)):($.fancybox.close(),i.updates?window.location="/user":alert("Error: Not sure what went wrong with your request, please refresh the page"))};$.getJSON(websiteFramework.BASE_URL+"ajax/",this.data,e)},this.init()}function forgotUser(t,e){var i={};return this.options=jQuery.extend(i,e),this.init=function(){return this.getElements(),this.setElements(),this},this.getElements=function(){this.form=$("#forgot"),this.userEmail=$("#forgot-email input"),this.wrapper=$(".forgot-action"),this.wrapper.find('input[type="submit"]').remove()},this.setElements=function(){var t=this;this.button=$("<button>").html("<div></div><span>Reset</span>").addClass("framework-button large forgot-button").click(function(e){return e.preventDefault(),t.regCheck(),!1}),this.wrapper.append(this.button),this.error=new errorHelper(this.wrapper)},this.regCheck=function(){this.button.attr("disabled","disabled"),this.overlay=new ajaxLoader(".fancybox-wrap"),this.data={email:this.userEmail.val(),flag:"forgot"},this.save()},this.save=function(){var t=this,e=function(e){var i=e;t.overlay.remove(),i.errors?(t.error.insertErrors(i),t.button.attr("disabled",!1)):$(".fancybox-wrap").find(".pre-window-wrap").html(i.html)};$.getJSON(websiteFramework.BASE_URL+"ajax/",this.data,e)},this.init()}function contact(t,e){var i={};this.options=jQuery.extend(i,e),this.init=function(){this.getElements(),this.setElements()},this.getElements=function(){this.form=$("#contact"),this.name=$("#contact-name"),this.email=$("#contact-email"),this.phone=$("#contact-phone"),this.message=$("#contact-message"),this.wrapper=$(".contact-action"),this.wrapper.find('input[type="submit"]').remove()},this.setElements=function(){var t=this;this.button=$("<button>").html("<div></div><span>Submit</span>").addClass("framework-button large contact-button").click(function(e){return e.preventDefault(),t.formCheck(),!1}),this.wrapper.append(this.button),this.error=new errorHelper(this.wrapper)},this.formCheck=function(){this.button.attr("disabled","disabled"),this.overlay=new ajaxLoader(".fancybox-wrap"),this.data={name:this.name.val(),email:this.email.val(),phone:this.phone.val(),message:this.message.val(),flag:"contact"},this.send()},this.send=function(){var t=this,e=function(e){var i=e;t.overlay.remove(),i.errors?(t.error.insertErrors(i),t.button.attr("disabled",!1)):$(".fancybox-wrap").find(".pre-window-wrap").html(i.html)};$.getJSON(websiteFramework.BASE_URL+"ajax/",this.data,e)},this.init()}function errorHelper(t,e){var i={};this.options=jQuery.extend(i,e),this.init=function(){this.errorWrapper=$("<div>").addClass("error-wrap"),this.parent.append(this.errorWrapper)},this.insertErrors=function(t){var e=this,i=t.errors;e.removeErrors(),$.each(i,function(t,i){e.insertError(i)})},this.insertError=function(t){this.errorWrapper.append($("<p>").html(t).addClass("reg-error"))},this.removeErrors=function(){this.errorWrapper.find("p.reg-error").remove()},this.parent=t,this.parent&&this.init()}function ajaxLoader(t,e){var i={bgColor:"#fff",duration:300,opacity:.7,classOveride:!1};this.options=jQuery.extend(i,e),this.container=$(t),this.init=function(){var t=this.container;this.remove();var e=$("<div></div>").css({"background-color":this.options.bgColor,opacity:this.options.opacity,width:t.outerWidth(),height:t.outerHeight(),position:"absolute",top:"0",left:"0"}).addClass("ajax_overlay");this.options.classOveride&&e.addClass(this.options.classOveride),t.append(e.append($("<div></div>").addClass("ajax_loader")).fadeIn(this.options.duration))},this.remove=function(t){var e=this.container.children(".ajax_overlay");e.length&&(t?e.remove():e.fadeOut(this.options.classOveride,function(){e.remove()}))},this.init()}function isEmpty(t){for(var e in t)return!0;return!1}var logoutUser=function(t){new ajaxLoader("body"),$.ajax({type:"POST",cache:!1,url:websiteFramework.BASE_URL+"ajax/",data:{flag:"logout",ajax:1},complete:function(){window.location.reload()}})};!function(t,e){e.transitions.resizeIn=function(){var i=e.previous,r=e.current,a=i.wrap.stop(!0).position(),n=t.extend({opacity:1},r.pos);a.width=i.wrap.width(),a.height=i.wrap.height(),i.wrap.stop(!0).trigger("onReset").remove(),delete n.position,r.inner.hide(),r.wrap.css(a).animate(n,{duration:r.nextSpeed,easing:r.nextEasing,step:e.transitions.step,complete:function(){e._afterZoomIn(),r.inner.fadeIn("fast")}})}}(jQuery,jQuery.fancybox);